
FROM vjtc0n/nest-base:1.0.0

ARG ENV_PROJECT=PRODUCTION
ENV ENV_PROJECT=${ENV_PROJECT}

ARG SWAGGER=yes
ENV SWAGGER=${SWAGGER}

ARG PORT=3000
ENV PORT=${PORT}

ARG AUTO_MIGRATION=false
ENV AUTO_MIGRATION=${AUTO_MIGRATION}

ARG JWT_SECRET_KEY=jwtsecret
ENV JWT_SECRET_KEY=${JWT_SECRET_KEY}

ARG JWT_EXP_TIME=86400
ENV JWT_EXP_TIME=${JWT_EXP_TIME}

ARG REFRESH_TOKEN_TTL=86400
ENV REFRESH_TOKEN_TTL=${REFRESH_TOKEN_TTL}

ARG REDIS_HOST=redis.abcd.private
ENV REDIS_HOST=${REDIS_HOST}

ARG REDIS_PORT=6379
ENV REDIS_PORT=${REDIS_PORT}

ARG DATABASE_NAME=
ENV DATABASE_NAME=${DATABASE_NAME}

ARG DATABASE_HOST=mysql.abcd.private
ENV DATABASE_HOST=${DATABASE_HOST}

ARG DATABASE_USERNAME=
ENV DATABASE_USERNAME=${DATABASE_USERNAME}

ARG DATABASE_PASSWORD=abc2019
ENV DATABASE_PASSWORD=${DATABASE_PASSWORD}

ARG DATABASE_PORT=3306
ENV DATABASE_PORT=${DATABASE_PORT}

WORKDIR /usr/src/app
EXPOSE 3000

COPY . .

RUN yarn build


# CMD sleep infinity
CMD yarn start

